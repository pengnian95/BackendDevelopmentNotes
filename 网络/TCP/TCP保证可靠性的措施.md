# TCP保证可靠性的措施

## 检验和
报文段分为多个16位的段，将所有段的反码相加，结果存放在检验和字段中。发送方和接收方均会进行一次计算。

## 序列号
* TCP对每个字节的数据都进行了编号。
* 序列号的作用：
	1. 保证可靠性（少了某个序号的数据时马上就知道了）
	2. 保证数据的按序到达
	3. 提高效率，可实现多次发送，一次到达
	4. 去除重复数据

## 确认应答机制ACK
* ACK表示报文中的确认号有效。∂
* 确认字段表示这个值之前的序列号的数据都已经到达了。
* 发送方接收到确认字段后会继续传输。

## 超时重传机制
发出后一定时间内没有收到接收方的确认，发送方就会重传。

## 连接管理机制
1. 三次握手
2. 四次挥手
[TCP的连接管理]()(bear://x-callback-url/open-note?id=1BBB94E5-CB94-498F-A11C-47A677DDD217-679-000050959D24C54A)

## 流量控制

* 接收端处理数据的速度是有限的，如果缓冲区满，则会导致丢包。
* TCP支持根据接收端的处理能力，决定发送端的发送速度。
* 实现方法： 滑动窗口

## 拥塞控制
主要有四个算法：慢开始、拥塞避免、快重传、快恢复
* 网络比较拥堵时，发送的数据段可能超过了最大生存时间也没有到达接收方，会产生丢包。
* TCP引入*慢启动*机制，先摸清当前的网络拥堵状态后，再决定按照多大的速度传输数据。
> 拥塞控制：拥塞控制是作用于**网络**的，它是防止过多的数据注入到网络中，避免出现网络负载过大的情况。
> 流量控制：流量控制是作用于**接收者**的，它是控制发送者的发送速度从而使接收者来得及接收。
慢开始、拥塞避免、快恢复：
![]()
1. 满开始
	从较低的速度开始传输，同时设定一个门限值ssthresh。
2. 快重传
	每次收到确认后，都将速度翻倍。
3. 拥塞避免
	达到ssthresh后，速度每次加一。
4. 快恢复
	1. 发送方连续收到三个重复确认时，执行“乘法减小”算法，把ssthresh门限减半，但并不执行慢开始。
	2. 将cwnd（当前拥塞窗口）设置为ssthresh的大小，执行拥塞避免算法。



