# 类加载过程
#3. JVM/类加载#
- - - -
## 类的生命周期
1. 加载
2. 验证
3. 准备
4. 解析
5. 初始化
6. 使用
7. 卸载
其中，1、2、3、5顺序确定。

## 类加载过程
### 一、加载
1. 通过一个类的全限定名来获取定义此类的二进制字节流，JVM把这个阶段的动作放在了虚拟机外部的“类加载器”中实现。未指明从哪里获取，因此有各种花样，比如从JAR包、WAR包，或者网络，或者运行时计算生成等等。
2. 将这个字节流所代表的的静态存储结构转化为::方法区::的运行时数据结构。
3. 在内存中生成一个代表这个类的java.lang.Class对象，作为方法区这个类的各种数据的访问入口。即**对象类型数据（非对象实例数据）存在方法区**。

### 二、验证
验证的目的是确保Class文件的字节流中包含的信息**不会危害虚拟机自身的安全**，直接决定了Java虚拟机是否能承受恶意代码的攻击。
* 验证阶段分为4个
	* 文件格式验证
	* 元数据验证
	* 字节码验证
	* 符合引用验证

### 三、准备
准备阶段**为类变量在方法区中分配内存并设置类变量的零值**
1. 这里只包含**类变量（即被static修饰的变量）**，而不是实例变量
2. 实例变量会在对象实例化时随着对象一起分配在Java堆中
3. 比如 public static int value =123;在准备阶段过后value=0，只有在初始化阶段之后，value才等于123.

### 四、解析
解析阶段是虚拟机将常量池内的符号引用替换为直接引用的过程
1. 符号引用也是描述所引用目标的，但引用的目标并不一定已经加载在内存中
2. 直接引用是指针、句柄这种，直接引用的目标必定以及在内存中存在。

### 五、初始化
初始化时类加载的最后一步，根据程序员的主观去**初始化类变量和其他资源**